<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbwUMVfgNSN9SAP4iWeA0Bjrd0iWC4-uD7xm0zCHKgNFuiRdK4PKlCVYMQIEmonEj4jf/exec";

document.getElementById("attendanceForm").addEventListener("submit", e => {
  e.preventDefault();

  const attendance = document.querySelector('input[name="attendance"]:checked')?.value;
  const late = document.querySelector('input[name="late"]:checked')?.value;

  if (!attendance || !late) {
    alert("Select Attendance & Late status");
    return;
  }

  const formData = new FormData();
  formData.append("emp_name", emp_name.value);
  formData.append("Site_Name", site_name.value);
  formData.append("attendance_type", attendance);
  formData.append("late_status", late);
  formData.append("remarks", remarks.value || "");
  formData.append("latitude", lat.value);
  formData.append("longitude", lon.value);

  fetch(scriptURL, {
    method: "POST",
    body: formData
  })
  .then(() => {
    alert("Attendance Submitted âœ…");
    e.target.reset();
    remarksBox.style.display = "none";
  })
  .catch(() => alert("Error submitting form"));
});
</script>

