<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Attendance</title>
</head>
<body>

<h2>Attendance Form</h2>

<form id="attendanceForm">
  <input type="text" name="emp_name" placeholder="Employee Name" required><br><br>
  <input type="text" name="site_name" placeholder="Site Name" required><br><br>

  <label>
    <input type="radio" name="attendance_type" value="Check In" required>
    Check In
  </label>
  <label>
    <input type="radio" name="attendance_type" value="Check Out">
    Check Out
  </label>
  <br><br>

  <label>
    <input type="radio" name="late_status" value="No" required>
    Not Late
  </label>
  <label>
    <input type="radio" name="late_status" value="Yes">
    Late
  </label>
  <br><br>

  <input type="text" name="remarks" placeholder="Remarks"><br><br>

  <!-- hidden fields for location -->
  <input type="hidden" name="latitude">
  <input type="hidden" name="longitude">

  <button type="submit">Submit</button>
</form>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbyTBHy8KEWrUTayBQ6t4t-1P5_j_jlYTShzO2hIzQ1QHKIwwNuS00Qr91QIaROfsScn/exec";
const form = document.getElementById("attendanceForm");

form.addEventListener("submit", function(e){
  e.preventDefault();

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      function(pos) {
        form.latitude.value = pos.coords.latitude;
        form.longitude.value = pos.coords.longitude;
        submitForm();
      },
      function() {
        submitForm(); // location deny hua to bhi submit
      }
    );
  } else {
    submitForm();
  }

  function submitForm() {
    const formData = new FormData(form);

    fetch(scriptURL, {
      method: "POST",
      body: formData
    })
    .then(() => {
      alert("Attendance Submitted ✅");
      form.reset();
    })
    .catch(() => alert("Error ❌"));
  }
});
</script>

</body>
</html>
